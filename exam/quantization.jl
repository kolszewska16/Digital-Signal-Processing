quantize(L::AbstractVector)::Function = x -> L[argmin(abs.(x .- L))]
energy(x::AbstractVector)::Real = sum(abs.(x) .^ 2)
power(x::AbstractVector)::Real = sum(abs.(x) .^ 2) / length(x)
rms(x::AbstractVector)::Real = sqrt(sum(abs.(x) .^ 2) / length(x))

# problem 2
# energia sygnału błędu kwantyzacji
function rozwiazanie2(;
    a::Float64 = -0.86,
    b::Float64 = 1.9,
    x::Vector{Float64} = [1.904, 1.85369, 1.80338, 1.75307, 1.70276, 1.65245, 1.60214, 1.55183, 1.50152, 1.4512, 1.40089, 1.35058, 1.30027, 1.24996, 1.19965, 1.14934, 1.09903, 1.04872, 0.99841, 0.9481, 0.89779, 0.84748, 0.79717, 0.74686, 0.69655, 0.64624, 0.59593, 0.54561, 0.4953, 0.44499, 0.39468, 0.34437, 0.29406, 0.24375, 0.19344, 0.14313, 0.09282, 0.04251, -0.0078, -0.05811, -0.10842, -0.15873, -0.20904, -0.25935, -0.30966, -0.35998, -0.41029, -0.4606, -0.51091, -0.56122, -0.61153, -0.66184, -0.71215, -0.76246, -0.81277, -0.86308],
)
    quantize(L) = x -> L[argmin(abs.(x .- L))]
    N = 8
    L = range(start = a, stop = b, length = 2 ^ N)

    q = quantize(L)
    x_q = q.(x)
    e = x - x_q
    
    energy = sum(abs.(e) .^ 2)
    return energy
end

# 0.0005527368564013786
rozwiazanie2()

# problem 5
# moc sygnału błędu kwantyzacji
function rozwiazanie5(;
    a::Float64 = -1.8,
    b::Float64 = -0.7,
    x::Vector{Float64} = [-0.95249, -0.93229, -0.9067, -0.8895, -0.87555, -0.85029, -0.8252, -0.81458, -0.79834, -0.76341, -0.74406, -0.75505, -0.71527, -1.78174, -1.6715, -1.63665, -1.63797, -1.6205, -1.58786, -1.56999, -1.55878, -1.53492, -1.50956, -1.49477, -1.47799, -1.45289, -1.43215, -1.41732, -1.39668, -1.3726, -1.35497, -1.33838, -1.31541, -1.29361, -1.27749, -1.25832, -1.23467, -1.21556, -1.19928, -1.17752, -1.15483, -1.13799, -1.12006, -1.0965, -1.07607, -1.06039, -1.03973, -1.0158, -0.99839, -0.98217, -0.95838, -0.93601, -0.92165, -0.90273, -0.87615, -0.85783, -0.84582, -0.82103, -0.79271, -0.78345, -0.77255, -0.72953, -0.69845, -1.009, -1.65916, -1.68134, -1.64381, -1.61209, -1.60441, -1.58885, -1.55944, -1.5393, -1.52701, -1.50512, -1.47973, -1.46346, -1.44731, -1.42317, -1.40151, -1.38622, -1.36657, -1.34251, -1.32397, -1.30773, -1.28547, -1.26305, -1.2465, -1.2281, -1.20456],
)
    quantize(L) = x -> L[argmin(abs.(x .- L))]
    N = 6
    L = range(start = a, stop = b, length = 2 ^ N)

    q = quantize(L)
    x_q = q.(x)
    e = x .- x_q
    power = sum((abs.(e) .^ 2) / length(e))
    return power
end

# 2.394851425740504e-5
rozwiazanie5()

# problem 6
# moc sygnału błędu kwantyzacji
function rozwiazanie6(;
    a::Float64 = -0.67,
    b::Float64 = 0.28,
    x::Vector{Float64} = [0.03, -0.03279, -0.09557, -0.15836, -0.22115, -0.28394, -0.34672, -0.40951, -0.4723, -0.53508, -0.59787, -0.66066, 0.27655, 0.21377, 0.15098, 0.08819, 0.02541, -0.03738, -0.10017, -0.16296, -0.22574, -0.28853, -0.35132, -0.4141, -0.47689, -0.53968, -0.60247, -0.66525, 0.27196, 0.20917, 0.14639, 0.0836, 0.02081, -0.04198, -0.10476, -0.16755, -0.23034, -0.29312, -0.35591, -0.4187, -0.48149, -0.54427, -0.60706, -0.66985, 0.26737, 0.20458, 0.14179, 0.079, 0.01622, -0.04657, -0.10936, -0.17214, -0.23493, -0.29772, -0.36051, -0.42329, -0.48608, -0.54887, -0.61165, -0.67444, 0.26277, 0.19998],
)
    quantize(L) = x -> L[argmin(abs.(x .- L))]
    N = 8
    L = range(start = a, stop = b, length = 2 ^ N)

    q = quantize(L)
    x_q = q.(x)
    e = x .- x_q
    power = sum((abs.(e) .^ 2) / length(e))
    return power
end      

# 1.4608983660130698e-6
rozwiazanie6()

# problem 16
# wartość skuteczna sygnału błędu kwantyzacji
function rozwiazanie16(;
    a::Float64 = -1.8,
    b::Float64 = 0.96,
    x::Vector{Float64} = [-0.176, -0.55802, -0.94003, -1.32205, -1.70406, -1.51392, -1.13191, -0.74989, -0.36788, 0.01414, 0.39616, 0.77817, 0.83981, 0.4578, 0.07578, -0.30623, -0.68825, -1.07026, -1.45228, -1.76571, -1.38369, -1.00167, -0.61966, -0.23764, 0.14437, 0.52639, 0.9084, 0.70958, 0.32757, -0.05445, -0.43647, -0.81848, -1.2005, -1.58251, -1.63547, -1.25346, -0.87144, -0.48943, -0.10741, 0.2746, 0.65662, 0.96136, 0.57935, 0.19733, -0.18468, -0.5667, -0.94871, -1.33073, -1.71274, -1.50524, -1.12322, -0.74121, -0.35919, 0.02282, 0.40484, 0.78685, 0.83113, 0.44912, 0.0671, -0.31491, -0.69693, -1.07895, -1.46096, -1.75702, -1.37501, -0.99299, -0.61098, -0.22896, 0.15305, 0.53507, 0.91709, 0.7009, 0.31888, -0.06313, -0.44515, -0.82716, -1.20918, -1.59119, -1.62679, -1.24478, -0.86276, -0.48074],
)
    N = 5
end